/*!------------Modifier: < tangentguo-PC0 > 2017-5-11 10:47:43------------*/

'use strict';window.sportInfoShow=function(option)
{
	var exeConunt=0;//执行次数
	var funcs=function funcs(){};
	var defaultOption={wrap:$('#sportINFO'),login:funcs,loginOut:funcs,vipCallback:funcs,cssUrl:'http://mat1.gtimg.com/pingjs/ext2020/dc2017/dist/sportInfo/sportInfo.css'};
	var option=$.extend(defaultOption,option);
	option.callBack=option.callBack||option.callback||funcs;
	//console.log(option);
	if(option.cssUrl){$('head').append('<link href="'+option.cssUrl+'"  charset="utf-8" rel="stylesheet">')}
	var unLoginHtml='\n        <div class="Sinfo-unlogin">\n            <div class="tourists">\n                <span class="t14">\u767B\u5F55\u540E\u53EF\u89C2\u770B\u66F4\u591A\u7CBE\u5F69\u6BD4\u8D5B</span>\n                <span class="login-btn t14 color-white color-golden1bg">\u767B\u5F55</span>\n            </div>\n        </div>\n    ';
	var loginedHtml='\n        <div class="Sinfo-logined">\n            <div class="list-top clearfix">\n                <a href="javascript:;" class="nick">\n                    <span class="js-username t14"></span>\n                </a>\n                <a href="http://vip.sports.qq.com/" target="_blank" class="vip-icons" style="cursor: pointer;"></a>\n                <a href="http://sports.qq.com/kbsweb/mycenter.htm#message" target="_blank" class="boss sys-msg">\n                    <span class="icon-email t16"></span>\n                    <span class="unread-msg color-red1bg color-white t12 js-unread-msg-count unread-msg-count"></span>\n                </a>\n                <a href="http://vip.sports.qq.com/" target="_blank" class="open-vip color-golden1bg color-white t14 fl" style="display: block;">\u5F00\u901A\u817E\u8BAF\u4F53\u80B2\u4F1A\u5458</a>\n            </div>\n            <div class="list-mid clearfix">\n                <a href="http://sports.qq.com/kbsweb/mycenter.htm#myWallet" target="_blank" class="wallet-myDiamonds fl">\n                    <span class="icon-diamond t18"></span>\n                    <span class="wallet-num t16 js-myDiamonds-count diamond-num">0</span>\n                </a>\n                <a href="http://sports.qq.com/kbsweb/mycenter.htm#myWallet" target="_blank" class="wallet-kb">\n                    <span class="icon-kb t18"></span>\n                    <span class="wallet-num t16 js-coin-count">0</span>\n                </a>\n                <a href="http://sports.qq.com/kbsweb/mycenter.htm#myWallet" target="_blank" class="wallet-ticket fr">\n                    <span class="icon-ticket t18"></span>\n                    <span class="wallet-num t16 js-ticket-count">0</span>\n                </a>\n            </div>\n            <div class="list-bot">\n                <a href="http://vip.sports.qq.com/" target="_blank" class="boss vip-center">\n                    <span class="icon-vip-logo logos t28 path1"></span><br>\n                    <span class="title t12">\u4F1A\u5458\u4E2D\u5FC3</span>\n                </a>\n                <a href="http://sports.qq.com/kbsweb/mycenter.htm#community" target="_blank" class="boss community-center">\n                    <span class="icon-shequ t28"></span>\n                    <span class="unread-msg js-unread-mymsg-count" style="display:none;"></span><br>\n                    <span class="title t12">\u6211\u7684\u793E\u533A</span>\n                </a>\n                <a href="http://sports.qq.com/kbsweb/mycenter.htm#myQuiz" target="_blank" class="boss guess-center">\n                    <span class="icon-guess t28"></span>\n                    <span class="unread-msg js-unread-guess-count" style="display:none;"></span><br>\n                    <span class="title t12">\u6211\u7684\u7ADE\u731C</span>\n                </a>\n                <a href="http://sports.qq.com/kbsweb/mycenter.htm#reminder" target="_blank" class="boss clock-panel-center">\n                    <span class="icon-clock-panel t28"></span><br>\n                    <span class="title t12">\u8D5B\u4E8B\u63D0\u9192</span>\n                </a>\n            </div>\n            <div class="change-btn">\n                <a class="boss" href="javascript:void(0);"><span class="js-change t14">\u5207\u6362\u8D26\u53F7</span></a>\n                <a class="boss quit" href="javascript:void(0);"><span class="js-logout t14">\u9000\u51FA\u767B\u5F55</span></a>\n            </div>\n        </div>\n    ';option.wrap.html(unLoginHtml);option.wrap.find('.login-btn').on('click',option.login);var refresh=function refresh(){//console.log(option);
var vip;if(option.isSportVip===undefined){vip=$.ajax({url:'http://matchweb.sports.qq.com/vip/status2?upgrade=1',dataType:'jsonp'})}else if($.type(option.isSportVip)=='array'){//console.log(option.isSportVip)
vip=[option.isSportVip,'success']}else{vip=[[0,{vip:option.isSportVip?'1':'0'}],'success']}//获取kb,mont,tick
var guess=$.ajax({url:'http://matchweb.sports.qq.com/guess/tcBalance?type=1:2:3',dataType:'jsonp'});var allCount=$.ajax({url:'http://shequweb.sports.qq.com/message/allCount',dataType:'jsonp'});/*会员类型：vip字段，0非会员，1普通会员，2高级会员
        会员是否可升级： canUpgrade非0表示可升级
        服务列表：services数组，里面serviceName表示套餐名，serviceIcon展示的icon*/var vipCb=function vipCb(d){//console.log(d)
if(!d)return;if(d&&d[0]==0&&d[1].vip>0){option.wrap.find('.open-vip').hide()}//所有服务展示出来
var services=d[1];if(services&&services.services&&services.services.length>0){var s='';$.each(services.services,function(n,el){if(el.serviceIcon){s+='<img title="'+el.serviceName+'" src="'+el.serviceIcon+'">'}});option.wrap.find('.vip-icons').html(s)}};//获取kb,mont,tick
var middlCb=function middlCb(d){if(d&&d.code==0){option.wrap.find('.js-coin-count').html(d.data.kb);option.wrap.find('.js-myDiamonds-count').html(d.data.diamond);option.wrap.find('.js-ticket-count').html(d.data.ticket)}};var botCb=function botCb(d){if(d&&d.code==0){d.data.sysCount<99&&d.data.sysCount>0&&option.wrap.find('.js-unread-msg-count').html(d.data.sysCount);if(d.data.shequCount>0){option.wrap.find('.js-unread-mymsg-count').show().html(d.data.shequCount)}if(d.data.guessCount>0){option.wrap.find('.js-unread-guess-count').show().html(d.data.guessCount)}}};$.when(vip,guess,allCount).done(function(d1,d2,d3){//console.log(d1,d2,d3)
d1&&vipCb(d1[0]);middlCb(d2[0]);botCb(d3[0]);option.callBack(d1,d2,d3)})};var logout=function logout(){option.loginOut();option.wrap.find('.login-btn').unbind('click');option.wrap.html(unLoginHtml);option.wrap.find('.login-btn').on('click',option.login)};var logincallback=function logincallback(event,user){//console.log(user);
exeConunt++;var userInfo=arguments[1]?user:event;if(!userInfo.nick)return;option.wrap.html(loginedHtml);option.wrap.find('.js-username').html(userInfo.nick).attr('title',userInfo.nick);option.wrap.find('.js-change').on('click',function(){logout();option.login()});option.wrap.find('.js-logout').on('click',logout);refresh()};$(window).on('login',logincallback);return{exeConunt:exeConunt,//执行次数
login:logincallback,refresh:refresh}};/*  |xGv00|a257bb96257d37cdad024f6b7dea7ee1 */